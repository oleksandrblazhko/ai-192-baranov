## V3.5 Керування сеансами на основі токенів
Управління сеансами на основі токенів включає JWT, OAuth, SAML та ключі API. Відомо, що ключі API є слабкими і не повинні використовуватися в новому коді.
### Опис
#### 3.5.1 (CWE 290)
Перевірка програми дозволяє користувачам відкликати токени OAuth, які формують довірчі відносини з пов'язаними додатками.
#### 3.5.2 (CWE 798)
Переконайтеся, що додаток використовує токени сеансу, а не статичні секрети та ключі API, за винятком застарілих реалізацій.
#### 3.5.3 (CWE 345)
Переконайтеся, що токени сеансу без збереження стану використовують цифрові підписи, шифрування та інші контрзаходи для захисту від підробки, конвертування, відтворення, нульового шифру та підміни ключів.


### Опис CWE
#### CWE 290
##### Опис
Ця вразливість спричинена некоректно реалізованими схемами аутентифікації, які піддаються атакам спуфінгу.

##### Загальні наслідки
| Сфера дії | Вплив |
|:-|:-|
| Управління доступом | Технічний вплив: Обхід механізму захисту; отримання привілеїв або привласнення особистих даних <br>Ця вразливість може дозволити зловмиснику отримати доступ до ресурсів, недоступних без належної аутентифікації. |


#### CWE 798
##### Опис
Продукт містить жорстко закодовані облікові дані, такі як пароль або криптографічний ключ, які він використовує для власної вхідної аутентифікації, вихідного зв'язку із зовнішніми компонентами або шифрування внутрішніх даних.
##### Розширений опис
Жорстко закодовані облікові дані зазвичай створюють значну прогалину, яка дозволяє зловмиснику обійти аутентифікацію, налаштовану адміністратором продукту. Системному адміністратору може бути важко виявити цю діру. Навіть якщо її буде виявлено, її може бути важко виправити, тому адміністратор може бути змушений повністю вимкнути продукт. Існує два основних варіанти:

Вхідний: продукт містить механізм аутентифікації, який перевіряє вхідні облікові дані з жорстко закодованим набором облікових даних. <br>
Вихідний: продукт підключається до іншої системи або компонента і містить жорстко закодовані облікові дані для підключення до цього компонента.

У вхідному варіанті створюється обліковий запис адміністратора за замовчуванням, і простий пароль жорстко кодується в продукті та асоціюється з цим обліковим записом. Цей пароль є однаковим для кожної інсталяції продукту, і зазвичай системні адміністратори не можуть змінити або вимкнути його без ручної модифікації програми або іншого виправлення продукту. Якщо пароль коли-небудь буде розкрито або опубліковано (що часто трапляється в Інтернеті), то будь-хто, хто знає цей пароль, зможе отримати доступ до продукту. Нарешті, оскільки всі інсталяції продукту матимуть однаковий пароль, навіть у різних організаціях, це уможливлює масові атаки, наприклад, за допомогою хробаків.

Вихідний варіант застосовується до зовнішніх систем, які аутентифікуються за допомогою внутрішнього сервісу. Внутрішній сервіс може вимагати фіксований пароль, який можна легко дізнатися. Програміст може просто жорстко закодувати ці внутрішні облікові дані у зовнішній продукт. Будь-який користувач цієї програми може дізнатися пароль. Клієнтські системи з жорстко закодованими паролями становлять ще більшу загрозу, оскільки витягти пароль з бінарного файлу зазвичай дуже просто.
##### Платформи, що застосовуються
- Мови <br>
Клас: не залежить від мови
- Технології <br>
Клас: Мобільний <br>
Клас: ICS/OT

##### Загальні наслідки
| Сфера дії | Вплив |
|:-|:-|
| Управління доступом | Технічний вплив: Механізм захисту від обходу <br>Якщо використовуються жорстко закодовані паролі, майже напевно зловмисники отримають доступ до відповідного облікового запису. |
| Цілісність <br>Конфіденційність <br>Доступність <br>Управління доступом <br>Інший |Технічний вплив: Читання даних програми; отримання привілеїв або присвоєння особистих даних; виконання несанкціонованого коду або команд; інше <br>Ця вразливість може призвести до того, що ресурси або функціонал будуть доступні стороннім особам, що, можливо, надасть зловмисникам доступ до конфіденційної інформації або навіть до виконання довільного коду.|
##### Ймовірність експлойту
Висока


#### CWE 345
##### Опис
Продукт недостатньо перевіряє походження або аутентичність даних, що призводить до того, що він приймає невірні дані.
##### Платформи, що застосовуються
- Мови <br>
Клас: не залежить від мови
- Технології <br>
Клас: ICS/OT

##### Загальні наслідки
| Сфера дії | Вплив |
|:-|:-|
| Цілісність <br>Інше | Технічний вплив: Залежить від контексту; Несподіваний стан |
