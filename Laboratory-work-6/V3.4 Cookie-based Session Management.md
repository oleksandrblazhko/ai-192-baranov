## V3.4 Керування сеансами на основі файлів cookie
### Опис
#### 3.4.1 (CWE 614)
Переконайтеся, що токени сеансу на основі файлів cookie мають атрибут "Безпечний". ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering))
#### 3.4.2 (CWE 1004)
Переконайтеся, що для токенів сеансу на основі файлів cookie встановлено атрибут "HttpOnly". ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering))
#### 3.4.3 (CWE 16)
Переконайтеся, що токени сеансу на основі файлів cookie використовують атрибут "SameSite" для обмеження впливу атак підробки міжсайтових запитів. ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering))
#### 3.4.4 (CWE 16)
Переконайтеся, що токени сеансу на основі файлів cookie використовують префікс "__Host-", щоб файли cookie надсилалися лише на хост, який спочатку встановив файли cookie
#### 3.4.5 (CWE 16)
Переконайтеся, що якщо програму опубліковано під доменним іменем з іншими програмами, які встановлюють або використовують файли cookie сеансу, які можуть розкривати файли cookie сеансу, установіть атрибут шляху в токенах сеансу на основі файлів cookie, використовуючи найточніший шлях. ([C6](https://owasp.org/www-project-proactive-controls/#div-numbering))
#### C6: Впровадження цифрової ідентичності
##### Опис
Цифрова ідентичність - це унікальне представлення користувача (або іншого суб'єкта) під час здійснення онлайн-транзакції. Аутентифікація - це процес перевірки того, що фізична або юридична особа є тією, за кого вона себе видає. Управління сеансами - це процес, за допомогою якого сервер підтримує стан аутентифікації користувачів, щоб користувач міг продовжувати користуватися системою без повторної аутентифікації. [Спеціальна публікація NIST 800-63B: Настанови з цифрової ідентичності (аутентифікація та управління життєвим циклом)](https://pages.nist.gov/800-63-3/sp800-63b.html) містить ґрунтовні рекомендації щодо впровадження засобів контролю цифрової ідентичності, аутентифікації та управління сеансами.



### Опис CWE
#### CWE 614
##### Опис
Атрибут «Безпечний» для конфіденційних файлів cookie в сеансах HTTPS не встановлено, що може призвести до того, що агент користувача надсилатиме ці файли cookie у вигляді відкритого тексту через сеанс HTTP.
##### Платформи, що застосовуються
- Технології <br>
Клас: Веб-орієнтований
##### Загальні наслідки
| Сфера дії | Вплив |
|:-|:-|
| Конфіденційність | Технічний вплив: читання даних програми|


#### CWE 1004
##### Опис
Продукт використовує файл cookie для зберігання конфіденційної інформації, але цей файл не позначений прапором "HttpOnly".
##### Розширений опис
Прапорець HttpOnly забороняє сумісним браузерам доступ до файлів cookie для скриптів на стороні клієнта. Включення прапорця HttpOnly в заголовок HTTP-відповіді Set Cookie допомагає зменшити ризик, пов'язаний з міжсайтовим скриптингом (XSS), коли код скрипта зловмисника може спробувати прочитати вміст файлу cookie і викрасти отриману інформацію. Якщо цей прапорець встановлено, браузери, які його підтримують, не розкриватимуть вміст файлу cookie третім особам через клієнтський скрипт, виконаний за допомогою XSS.
##### Платформи, що застосовуються
- Мови <br>
Клас: не залежить від мови
- Технології <br>
Клас: Веб-орієнтований

##### Загальні наслідки
| Сфера дії | Вплив |
|:-|:-|
| Конфіденційність | Технічний вплив: читання даних програми <br>Якщо прапорець HttpOnly не встановлено, то конфіденційна інформація, що зберігається в файлі cookie, може стати доступною стороннім особам. |
| Цілісність | Технічний вплив: отримати привілеї або присвоїти особистість <br>Якщо файл cookie, про який йде мова, є файлом cookie для аутентифікації, то невстановлення прапорця HttpOnly може дозволити зловмиснику викрасти дані аутентифікації (наприклад, ідентифікатор сеансу) і привласнити особистість користувача. |
##### Ймовірність експлойту
Середня


#### CWE 16
##### Опис категорії
Вразливості з цієї категорії зазвичай з’являються під час налаштування програмного забезпечення.
